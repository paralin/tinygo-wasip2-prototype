<!doctype html>
<html>
  <head>
    <title>TinyGo WASI Preview2 Demo</title>
    <style>
      body {
        font-family: system-ui, sans-serif;
        max-width: 800px;
        margin: 0 auto;
        padding: 20px;
      }
      pre {
        background: #f5f5f5;
        padding: 10px;
        border-radius: 4px;
        overflow: auto;
        max-height: 300px;
      }
    </style>
  </head>
  <body>
    <h1>TinyGo WASI Preview2 Demo</h1>

    <h2>Console Output</h2>
    <pre id="output"></pre>

    <script>
      // Capture console output and display it on page
      const originalConsoleLog = console.log
      const originalConsoleError = console.error
      const originalConsoleWarn = console.warn

      console.log = function () {
        appendToOutput('[LOG]', arguments, 'log')
        originalConsoleLog.apply(console, arguments)
      }

      console.error = function () {
        appendToOutput('[ERROR]', arguments, 'error')
        originalConsoleError.apply(console, arguments)
      }

      console.warn = function () {
        appendToOutput('[WARN]', arguments, 'warn')
        originalConsoleWarn.apply(console, arguments)
      }

      function appendToOutput(prefix, args, type) {
        const output = document.getElementById('output')
        let line = prefix + ' '

        for (let i = 0; i < args.length; i++) {
          const arg = args[i]
          if (typeof arg === 'object') {
            line += JSON.stringify(arg, null, 2) + ' '
          } else {
            line += arg + ' '
          }
        }

        const entry = document.createElement('div')
        entry.classList.add(type)
        entry.textContent = line
        output.appendChild(entry)

        // Auto-scroll to bottom
        output.scrollTop = output.scrollHeight
      }
    </script>

    <script type="module" src="dist/bundle.js"></script>
  </body>
</html>
